App As appinfo:
    BackEnabled: =false
    OnStart: |+
        =//Start concurrent  ------------------------------------------------------------------
        Concurrent(
        
        //Lấy tất cả phòng về
        Collect(
            gblColDepartment,
            ShowColumns('ASTakeLeave.Department', "ID", "name", "divisionID", "active")
        ),
        
        //Lấy tất cả khối về
        Collect(
            gblColDivision,
            ShowColumns('ASTakeLeave.Division', "ID", "name", "directorUserID", "active")
        ),
        
        //Lấy các cấp phê duyệt cấp cao
        Collect(gblColManagerHighLevel,Filter('ASTakeLeave.CommonRelationship',active = 1));
        
        //Lấy bảng lịch làm việc
        Collect(gblColWeekDay,'ASTakeLeave.WeekDay'),
        //Lấy bảng lịch ngày lễ
        Collect(gblColHoliday,'ASTakeLeave.Holiday');
        
        );
        //End concurent     -------------------------------------------------------------
        
    StartScreen: |-
        =If(
            LookUp(
                'ASTakeLeave.Users_Roles',
                userID = LookUp(
                    'ASTakeLeave.Users',
                    email = User().Email And active = 1
                ).userID And active = 1
            ).roleID = 6,
            'User Screen',
            LookUp(
                'ASTakeLeave.Users_Roles',
                userID = LookUp(
                    'ASTakeLeave.Users',
                    email = User().Email And active = 1
                ).userID And active = 1
            ).roleID = 1,
            'Home User Screen',
            'Home Manager Screen'
        )
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

